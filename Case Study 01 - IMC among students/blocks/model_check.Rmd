### First Experiment
The first experiment tests if there's a difference in the BMI of male students and female students.

#### Independence of samples:
It's assumed that all samples and independent for the study on all three experiments.


#### Normality check:

For verifying distribution normality, the Shapiro-Wilk test is applied. If the p-value is less than our significance level of 0.05, then the null hypothesis is rejected, and the data is not normally distributed.


```{r test1_norm_check}
p_male_stundents <- shapiro.test(male_students$IMC)$p.value #OK
p_female_stundents <- shapiro.test(female_students$IMC)$p.value #OK
```

The results above indicates:

- Male students p-value = `r p_male_stundents`  
- Female students p-value = `r p_female_stundents`  


Since the p-value is greater than 0.05, the null hypothesis is not rejected, and the data is normally distributed. A plot demonstrating data normality can be seen below.

```{r test1_norm_checkplot}
par(mfrow=c(1,2))
qqPlot(male_students$IMC, main="Male students")
qqPlot(female_students$IMC, main="Female students")
```


#### Equality of variances:
The result of the Fligner-Killeen test below shows that both distribution have an equal variance on it's population.


```{r results='hold'}
FvsM= stack(list(Female=female_students$IMC, Male=male_students$IMC))
fligner.test(values~ind,FvsM) 
```

```{r}
resid <- tapply(X = FvsM$values, INDEX = FvsM$ind, FUN = function(x){x - mean(x)})
stripchart(x = resid,vertical = TRUE,pch = 16,cex = 1.5,las = 1,xlab = "mean",ylab = "residuals", main = "Stripchart - Residue from Female and Male population's mean")
```



### Second Experiment
The second experiment tests if there's a difference in the BMI of male students from different semesters. 


#### Normality check:

For verifying distribution normality, the Shapiro-Wilk test is applied. If the p-value is less than our significance level of 0.05, then the null hypothesis is rejected, and the data is not normally distributed.

```{r test2_norm_check}

p_male_stundents2016 <-shapiro.test(male_students2016$IMC)$p.value #OK
p_male_stundents2017 <-shapiro.test(male_students2017$IMC)$p.value #OK

```

The results above indicates:

- 2016/2 students p-value = `r p_male_stundents2016`  
- 2017/2 students p-value = `r p_male_stundents2017`  

Since the p-value is greater than 0.05, the null hypothesis is not rejected, and the data is normally distributed. A plot demonstrating data normality can be seen below.




```{r test2_norm_checkplot}

par(mfrow=c(1,2))
qqPlot(male_students2016$IMC, main="2016/2 male students")
qqPlot(male_students2017$IMC, main="2017/2 male students")

```


#### Equality of variances:
The result of the Fligner-Killeen test below shows that both distribution have an equal variance on it's population.

```{r test2_var_check}

# Verify equality of variances between data sets (Male vs Female)
M2016vsM2017 = stack(list(Male_2016 = male_students2016$IMC,
                          Male_2017 = male_students2017$IMC)
                     )

fligner.test(values~ind,M2016vsM2017) # OK


resid_m2016_17 <- tapply(X = M2016vsM2017$values, INDEX = M2016vsM2017$ind, FUN = function(x){x - mean(x)})

stripchart(x = resid_m2016_17, vertical = TRUE,pch = 16,cex = 1.5,las = 1,xlab = "mean",ylab = "residuals", main = "Stripchart - Residue mean from 2016 and 2017 Male students")



```

 


### Third Experiment

- Data: Female 2016-2 and Female 2017-2
```{r}
p_female_stundents2016 <-shapiro.test(female_students2016$IMC)$p.value #OK
qqPlot(female_students2016$IMC)
p_female_stundents2017 <-shapiro.test(female_students2017$IMC)$p.value #NOT OK
qqPlot(female_students2017$IMC)
```

Since the dataset 'female_students2017' cannot be assumed normal, a non-parametric test must be issued for this case:

```{r}
wilcox.test(female_students2016$IMC,female_students2017$IMC)
```